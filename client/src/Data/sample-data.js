
import { v4 as uuidv4 } from "uuid";

let sampleLemmata = [
  {
    "lemmaId": "676905a6-25ea-409d-9a83-eebfa8d27de4",
    "published": true,
    "translation": "furrow",
    "language": "akkadian",
    "original": "ABSIN",
    "transliteration": "Å¡er'u",
    "partOfSpeech": "noun",
    "meanings": [
      {"id": 1, "value": "Virgo (zodiacal sign)"},
      {"id": 2, "value": "Furrow (constellation)"}
    ],
    "variants": [
      {
        "id": 1,
        "original": "mulABSIN",
        "transliteration": "Å¡er'u"
      },
      {
        "id": 2,
        "original": "mul2ABSIN",
        "transliteration": "Å¡er'u"
      },
      {
        "id": 3,
        "original": "ABSIN0 (KI)",
        "transliteration": "Å¡er'u"
      },
      {
        "id": 4,
        "original": "mulAB.SIN2",
        "transliteration": "Å¡er'u"
      }
    ],
    "crosslinks": [
      {
        "id": 1,
        "link": "ac711882-e49e-48f8-9969-e794206a3626"
      }
    ],
    "quotations": [
      {
        "id": 1,
        "original": "mul2UR.A mul2ABSIN mul2GIR2.TAB PA.BIL MAÅ 2 u KUN.ME PAP 6 KI.MEÅ  Å¡a2 sin ina Å A3-Å¡i-na TUR3 NIGIN2-ma ana 8-i u4-mu IM Å AR2-tu u ZI.A",
        "transliteration": "",
        "translation": "The Lion (Leo), the Furrow (Virgo), the Scorpion (Scorpio), Pabilsag (Sagittarius), the Goat-Fish (Capricorn) and the Tails (Pisces): in total 6 areas where Sin, (if) he is surrounded by a halo within them, then for 8 days wind and ...",
        "source": "AO 6455 (TU 11) rev. 29",
        "genre": "astrological and astronomical procedure text",
        "provenance": "Uruk",
        "date": "ca. 200 BCE",
        "publication": "Brack-Bernsen & Hunger 2002 (see BibMAS)",
        "link": ""
      },
      {
        "id": 2,
        "original": "TA 13 ABSIN0 EN 27 zib ITI ana ITI 2.â¸¢6â¸£.15.42 TAB u LA2",
        "transliteration": "",
        "translation": "From 13 Furrow (Virgo) until 27 Tails (Pisces) month by month 2,6;15,42 add and subtract.",
        "source": "BM 55530 (Ossendrijver 2012 No. 60) obv. 8'",
        "genre": "mathematical astronomy procedure text",
        "provenance": "Babylon",
        "date": "",
        "publication": "Ossendrijver 2012 (see BibMAS)",
        "link": ""
      },
      {
        "id": 3,
        "original": "DIS mulGU4.AN.NA mulAB.SIN2 u mul[SUá¸ªUR.MAÅ ] 3 KI.MEÅ  a-n[a kur]â¸¢NIM?â¸£. [MAki]",
        "transliteration": "",
        "translation": "The Bull of Heaven (Taurus), the Furrow (Virgo), and the Goat-Fish (Capricorn): 3 areas for [Elam].",
        "source": "BM 47494 rev. 17-18",
        "genre": "astrological compendium",
        "provenance": "Babylon?",
        "date": "ca. 3xx BCE",
        "publication": "Hunger 2004 (see BibMAS)",
        "link": ""
      }
    ],
    "externalLinks": []
  },
  {
    "lemmaId": "fa9850a3-288c-4af2-8933-607a88ee4962",
    "published": true,
    "translation": "Sheep",
    "language": "egyptian",
    "original": "ð“ƒ",
    "transliteration": "á»‰sw",
    "partOfSpeech": "noun",
    "meanings": [
      {"id": 1, "value": "Aries"},
      {"id": 2, "value": "Ram"}, 
      {"id": 3, "value": "Sheep"}
    ],
    "variants": [
      {
        "id": 1,
        "original": "ð“Šƒð“‚‹ð“„›",
        "transliteration": "sr"
      },
      {
        "id": 2,
        "original": "ð“¶",
        "transliteration": "tpy"
      }
    ],
    "crosslinks": [
      {
        "id": 1,
        "link": "ac711882-e49e-48f8-9969-e794206a3626"
      }
    ],
    "quotations": [
      {
        "id": 1,
        "original": "",
        "transliteration": "á»‰bd 2 pr.t pêœ£ á»‰sw",
        "translation": "Month 2 of Peret (Mecheir): Aries",
        "source": "O.Strasb. 521.7",
        "genre": "Astrological/Astronomical list",
        "provenance": "Egypt",
        "date": "Roman",
        "publication": "O. Neugebauer, â€œDemotic Horoscopesâ€, JAOS 63 (1943), 121â€“121 (115â€“127).",
        "link": ""
      },
      {
        "id": 2,
        "original": "",
        "transliteration": "pêœ£ rêœ¥-á¸«êœ¥ têœ£ á»‰á¸«y(.t) | rêœ¥-á¸¥tp pêœ£ á»‰sw",
        "translation": "Ascendant: Libra; Descendant: Aries",
        "source": "O.Neugebauer 3.4â€“5",
        "genre": "Horoscope",
        "provenance": "Thebes",
        "date": "after AD 18",
        "publication": "O. Neugebauer, â€œDemotic Horoscopesâ€, JAOS 63 (1943), 117â€“119 (115â€“127).",
        "link": ""
      }
    ],
    "externalLinks": [
      {
        "id": 1,
        "url": "http://aaew2.bbaw.de/tla/servlet/GetWcnDetails?wn=00700&db=1",
        "display": "TLA: á»‰sw"
      },
      {
        "id": 2,
        "url": "https://www.dwl.aegyptologie.lmu.de/suche.php?nummer=00700",
        "display": "DWL: á»‰sw"
      }
    ]
  },
  {
    "lemmaId": "ac711882-e49e-48f8-9969-e794206a3626",
    "published": true,
    "translation": "ram",
    "language": "greek",
    "original": "ÎºÏÎ¹ÏŒÏ‚",
    "transliteration": "krios",
    "partOfSpeech": "noun",
    "meanings": [
      {"id": 1, "value": "Aries (zodiac sign)"}, 
      {"id": 2, "value": "Aries (constellation)"}
    ],
    "variants": [],
    "crosslinks": [
      {
        "id": 1,
        "link": "fa9850a3-288c-4af2-8933-607a88ee4962"
      },
      {
        "id": 2,
        "link": "676905a6-25ea-409d-9a83-eebfa8d27de4"
      }
    ],
    "quotations": [
      {
        "id": 1,
        "original": "Î¶Ï‰ÏŠÎ´Î¯Ï‰Î½ Î´Î­ á¼‘ ÎºÏÎºÎ»Î¿Î½ á¼Ï€Î¯ÎºÎ»Î·ÏƒÎ¹Î½ ÎºÎ±Î»Î­Î¿Ï…ÏƒÎ¹Î½â€€ Ï„á¿· á¼”Î½Î¹ ÎšÎ±ÏÎºÎ¯Î½Î¿Ï‚ á¼ÏƒÏ„Î¯, Î›Î­Ï‰Î½ á¼Ï€á½¶ Ï„á¿·, Î¼ÎµÏ„á½° Î´â€™ Î±á½Ï„á½¸Î½ Î Î±ÏÎ¸Î­Î½Î¿Ï‚â€€ Î±á¼± Î´â€™ á¼Ï€Î¯ Î¿á¼± Î§Î·Î»Î±á½¶ ÎºÎ±á½¶ Î£ÎºÎ¿ÏÏ€Î¯Î¿Ï‚ Î±á½Ï„á½¸Ï‚ Î¤Î¿Î¾ÎµÏ…Ï„Î®Ï‚ Ï„Îµ ÎºÎ±á½¶ Î‘á¼°Î³ÏŒÎºÎµÏÏ‰Ï‚, á¼Ï€á½¶ Î´â€™ Î‘á¼°Î³Î¿ÎºÎµÏá¿†ÏŠ á½™Î´ÏÎ¿Ï‡ÏŒÎ¿Ï‚â€€ Î´ÏÎ¿ Î´â€™ Î±á½Ï„á¿· á¼”Ï€â€™ á¼¸Ï‡Î¸ÏÎµÏ‚ á¼€ÏƒÏ„ÎµÏÏŒÎµÎ½Ï„ÎµÏ‚, Ï„Î¿á½ºÏ‚ Î´á½² Î¼Î­Ï„Î± ÎšÏÎ¹ÏŒÏ‚, Î¤Î±á¿¦ÏÎ¿Ï‚ Î´â€™ á¼Ï€á½¶ Ï„á¿· Î”Î¯Î´Ï…Î¼Î¿Î¯ Ï„Îµ. á¼Î½ Ï„Î¿á¿–Ï‚ á¼ Î­Î»Î¹Î¿Ï‚ Ï†Î­ÏÎµÏ„Î±Î¹ Î´Ï…Î¿ÎºÎ±Î¯Î´ÎµÎºÎ± Ï€á¾¶ÏƒÎ¹Î½ Ï€Î¬Î½Ï„â€™ á¼Î½Î¹Î±Ï…Ï„á½¸Î½ á¼„Î³Ï‰Î½, ÎºÎ±Î¯ Î¿á¼± Ï€ÎµÏá½¶ Ï„Î¿á¿¦Ï„Î¿Î½ á¼°ÏŒÎ½Ï„Î¹ ÎºÏÎºÎ»Î¿Î½ á¼€Î­Î¾Î¿Î½Ï„Î±Î¹ Ï€á¾¶ÏƒÎ±Î¹ á¼Ï€Î¹ÎºÎ¬ÏÏ€Î¹Î¿Î¹ á½§ÏÎ±Î¹.",
        "transliteration": "",
        "translation": "They call it (sc. the ecliptic) by the name 'Circle of the figurines' (zÅdiÅn kyklos, i.e. the zodiac): in it is Cancer, after that there is Leo, after that is Virgo, and after that, the Claws and Scorpio itself, Sagittarius and Capricorn, and after Capricorn, Aquarius, and after it, the two stary Fish (i.e. Pisces), and after them Aries, and after it Taurus and Gemini. In all twelve of them the Sun moves along as it passes each year, and as it goes around this circle, all the seasons wax fruitful.",
        "source": "Aratus 543â€“552",
        "genre": "didactic poem on astronomy",
        "provenance": "Pella",
        "date": "ca. 276â€“274 BCE",
        "publication": "",
        "link": ""
      },
      {
        "id": 2,
        "original": "Ï„á¿· Î´á½² Î¼Î·Î½á½¶ Ï„á¿· ÎžÎ±Î½Î¸Î¹Îºá¿·, á½ƒÏ‚ ÎÎ¹Ïƒá½°Î½ Ï€Î±Ïâ€™ á¼¡Î¼á¿–Î½ ÎºÎ±Î»Îµá¿–Ï„Î±Î¹ ÎºÎ±á½¶ Ï„Î¿á¿¦ á¼”Ï„Î¿Ï…Ï‚ á¼ÏƒÏ„á½¶Î½ á¼€ÏÏ‡Î®, Ï„ÎµÏƒÏƒÎ±ÏÎµÏƒÎºÎ±Î¹Î´ÎµÎºÎ¬Ï„á¿ƒ ÎºÎ±Ï„á½° ÏƒÎµÎ»Î®Î½Î·Î½ á¼Î½ ÎºÏÎ¹á¿· Ï„Î¿á¿¦ á¼¡Î»Î¯Î¿Ï… ÎºÎ±Î¸ÎµÏƒÏ„á¿¶Ï„Î¿Ï‚â€€ Ï„Î¿ÏÏ„á¿³ Î³á½°Ï Ï„á¿· Î¼Î·Î½á½¶ Ï„á¿†Ï‚ á½‘Ï€â€™ Î‘á¼°Î³Ï…Ï€Ï„Î¯Î¿Ï…Ï‚ Î´Î¿Ï…Î»ÎµÎ¯Î±Ï‚ á¼ Î»ÎµÏ…Î¸ÎµÏÏŽÎ¸Î·Î¼ÎµÎ½",
        "transliteration": "",
        "translation": "(The sacrifice of pascha is celebrated) in the month of Xanthikos, which among us (sc. Jews) is called Nisan and is the beginning of the year, on the fourteenth (of the month) according to the Moon, when the Sun is in Ariesâ€”for in this month we were liberated from servitude to Egyptians",
        "source": "Josephus, Antiquities of the Jews 3.10.5 (248)",
        "genre": "history",
        "provenance": "Rome",
        "date": "93/94 CE",
        "publication": "",
        "link": ""
      },
      {
        "id": 3,
        "original": "ÎšÏÎ¹ÏŒÏ‚ á¼ÏƒÏ„Î¹Î½ Î¿á¼¶ÎºÎ¿Ï‚ á¼ŒÏÎµÏ‰Ï‚, Î¶á¿´Î´Î¹Î¿Î½ á¼€ÏÏÎµÎ½Î¹ÎºÏŒÎ½, Ï„ÏÎ¿Ï€Î¹ÎºÏŒÎ½, Ï‡ÎµÏÏƒÎ±á¿–Î¿Î½, á¼¡Î³ÎµÎ¼Î¿Î½Î¹ÎºÏŒÎ½, Ï€Ï…Ïá¿¶Î´ÎµÏ‚, á¼Î»ÎµÏÎ¸ÎµÏÎ¿Î½, á¼€Î½Ï‰Ï†ÎµÏÎ­Ï‚, á¼¡Î¼Î¯Ï†Ï‰Î½Î¿Î½, á¼€Î³Î±Î¸ÏŒÎ½, Îµá½Î¼ÎµÏ„Î¬Î²Î¿Î»Î¿Î½, Î´Î¹Î¿Î¹ÎºÎ·Ï„Î¹ÎºÏŒÎ½, Î´Î·Î¼ÏŒÏƒÎ¹Î¿Î½, Ï€Î¿Î»Î¹Ï„Î¹ÎºÏŒÎ½, á½€Î»Î¹Î³ÏŒÎ³Î¿Î½Î¿Î½, Î»Î±Ï„Ïá¿¶Î´ÎµÏ‚, ÎºÏŒÏƒÎ¼Î¿Ï… Î¼ÎµÏƒÎ¿Ï…ÏÎ¬Î½Î·Î¼Î± ÎºÎ±á½¶ Î´ÏŒÎ¾Î·Ï‚ Î±á¼´Ï„Î¹Î¿Î½, Î´Î¯Ï‡ÏÏ‰Î¼Î¿Î½ á¼Ï€Îµá½¶ á½ á¼­Î»Î¹Î¿Ï‚ ÎºÎ±á½¶ á¼¡ Î£ÎµÎ»Î®Î½Î· Ï€Î¿Î¹Î¿á¿¦ÏƒÎ¹Î½ á¼€Î»Ï†Î¿ÏÏ‚, Î»ÎµÎ¹Ï‡á¿†Î½Î±Ï‚â€€ á¼”ÏƒÏ„Î¹ Î´á½² ÎºÎ±á½¶ á¼€ÏƒÏÎ½Î´ÎµÏ„Î¿Î½, á¼ÎºÎ»ÎµÎ¹Ï€Ï„Î¹ÎºÏŒÎ½",
        "transliteration": "",
        "translation": "Aries is a house of Ares, a masculine zodiac-sign, tropic, of dry-land, hegemonic, of fire, of free men, ascending, semi-voiced, good, variable, controlling, of the (common) people, political, of low fertility, servile, the midheaven of the cosmos and a source of glory, two-colored when Sun and Moon produce spots (and) cankers; it is also non-conjunctive, ecliptic",
        "source": "Vettius Valens 1.2.1",
        "genre": "astrological treatise",
        "provenance": "Antioch",
        "date": "ca. 152â€“162 CE",
        "publication": "",
        "link": ""
      }
    ],
    "externalLinks": [
      {
        "id": 1,
        "url": "http://stephanus.tlg.uci.edu/Iris/inst/lexica.jsp#qid=174929&ql=KRIO%2FS%2C%20-OU%3D%2C%20O(&q=%CE%BA%CF%81%CE%B9%CF%8C%CF%82%2C%20%E2%80%91%CE%BF%E1%BF%A6%2C%20%E1%BD%81&usr_input=greek",
        "display": "TLG: ÎºÏÎ¹ÏŒÏ‚"
      }
    ]
  }
];


// Load lemmata from localStorage if available, otherwise set it to default sample data
// This is temporary until we get the real database
// -CDC 2022-08-11

let lemmata = null;
lemmata = JSON.parse(localStorage.getItem('lemmata') || null);
if (!lemmata) {
  localStorage.setItem("lemmata", JSON.stringify(sampleLemmata));
  lemmata = sampleLemmata;
}

export function getLemmataList(token) {
  let lemmataList = lemmata.map(lemma => {
    return {
    lemmaId: lemma.lemmaId,
    published: lemma.published,
    translation: lemma.translation,
    original: lemma.original,
    transliteration: lemma.transliteration,
    language: lemma.language,
  }})
  if (!token)
    lemmataList = lemmataList.filter(lemma => lemma.published)
  return lemmataList;
}

export function addNewLemma() {
  // Move some of this back into <Sidebar />
  // esp. the creation of the new object and the id
  lemmata = JSON.parse(localStorage.getItem('lemmata') || null);
  if (!lemmata)
    throw new Error('Problem with sample data in localStorage');
  
  let newLemmaId = uuidv4();
  const newLemma = {
    lemmaId: newLemmaId,
    published: false,
    translation: '',
    language: '',
    original: '',
    transliteration: '',
    partOfSpeech: '',
    meanings: [],
    variants: [],
    crosslinks: [],
    quotations: [],
    
    changed: true,
  };
  
  lemmata.push(newLemma);
  localStorage.setItem("lemmata", JSON.stringify(lemmata));
  
  return newLemmaId;
}

export function getLemma(lemmaId) {
  return lemmata.find(lemma => lemma.lemmaId === lemmaId);
}

export function saveLemmaToDB(newLemma) {
  const newLemmata = lemmata.map(lemma => {
      if (lemma.lemmaId === newLemma.lemmaId) {
        return newLemma;
      }
      return lemma;
    });
  lemmata = newLemmata;
  localStorage.setItem("lemmata", JSON.stringify(newLemmata));
}

export function deleteLemmaFromDB(lemmaId) {
  
  // Don't delete the very last lemma or everything fubars
  if (lemmata.length <= 1)
    return;
  
  const newLemmata = lemmata.filter(lemma => {
    return (lemma.lemmaId !== lemmaId);
  });
  lemmata = newLemmata;
  
  // REPLACE WITH A PROPER LAMBDA FUNCTION CALL
  localStorage.setItem("lemmata", JSON.stringify(newLemmata));
};
